# Task 29: Руководство по ручному тестированию

## Подготовка к тестированию

### Предварительные требования

1. **Backend запущен:**
   ```bash
   cd backend_laravel
   php artisan serve
   ```

2. **Frontend запущен:**
   ```bash
   cd frontend_next
   npm run dev
   ```

3. **База данных:**
   - Убедитесь, что база данных содержит тестовые данные
   - Есть хотя бы один администратор для входа
   - Есть несколько проектов и блог-постов для тестирования

4. **Браузеры:**
   - Chrome (основной)
   - Firefox (для кросс-браузерного тестирования)
   - Safari (если доступен)

### Тестовые данные

Подготовьте следующие файлы для тестирования загрузки:

**Изображения:**
- ✅ Валидное изображение < 2MB (jpg/png/webp)
- ❌ Изображение > 2MB (для проверки валидации)
- ❌ Неподдерживаемый формат (gif/bmp)

**Видео:**
- ✅ Валидное видео < 50MB (mp4/webm) + постер
- ❌ Видео > 50MB (для проверки валидации)
- ❌ Видео без постера (для проверки валидации)
- ❌ Неподдерживаемый формат (avi/mov)

## Порядок тестирования

### Этап 1: Базовая авторизация и навигация

#### 1.1 Проверка страницы логина

**Шаги:**
1. Откройте `http://localhost:3000/admin/login`
2. Проверьте, что sidebar НЕ отображается
3. Проверьте наличие полей username и password
4. Проверьте наличие чекбокса "Запомнить меня"

**Ожидаемый результат:**
- ✅ Sidebar скрыт
- ✅ Форма отображается корректно
- ✅ Чекбокс "Запомнить меня" присутствует

**Проверка autocomplete:**
1. Откройте DevTools → Elements
2. Найдите поле username
3. Проверьте атрибут `autocomplete="username"`
4. Найдите поле password
5. Проверьте атрибут `autocomplete="current-password"`

**Ожидаемый результат:**
- ✅ Атрибуты autocomplete установлены правильно

#### 1.2 Вход в систему

**Шаги:**
1. Введите credentials администратора
2. Отметьте чекбокс "Запомнить меня"
3. Нажмите "Войти"
4. Обратите внимание на предложение браузера сохранить пароль

**Ожидаемый результат:**
- ✅ Вход выполнен успешно
- ✅ Редирект на `/admin`
- ✅ Браузер предложил сохранить пароль
- ✅ Sidebar теперь отображается

#### 1.3 Проверка навигации

**Шаги:**
1. Проверьте все пункты меню в sidebar
2. Кликните на каждый пункт
3. Проверьте, что активный пункт подсвечивается

**Пункты меню для проверки:**
- [ ] Dashboard
- [ ] Проекты
- [ ] Блог
- [ ] Категории
- [ ] SEO
- [ ] Homepage Editor
- [ ] Media Page
- [ ] Настройки → Сменить пароль

**Ожидаемый результат:**
- ✅ Все пункты меню работают
- ✅ Активный пункт подсвечивается
- ✅ Нет ошибок в консоли

### Этап 2: Функция смены пароля

#### 2.1 Открытие страницы смены пароля

**Шаги:**
1. В sidebar найдите пункт "Настройки" или "Сменить пароль"
2. Кликните на него
3. Проверьте URL: `/admin/settings/change-password`

**Ожидаемый результат:**
- ✅ Страница открылась
- ✅ Форма с тремя полями отображается

#### 2.2 Валидация формы

**Тест 1: Неправильный текущий пароль**
1. Введите неправильный текущий пароль
2. Введите новый пароль (минимум 8 символов)
3. Подтвердите новый пароль
4. Нажмите "Сменить пароль"

**Ожидаемый результат:**
- ✅ Ошибка "Текущий пароль неверен"
- ✅ Сообщение на русском языке

**Тест 2: Несовпадающие пароли**
1. Введите правильный текущий пароль
2. Введите новый пароль
3. Введите другое подтверждение
4. Нажмите "Сменить пароль"

**Ожидаемый результат:**
- ✅ Ошибка "Пароли не совпадают"
- ✅ Сообщение на русском языке

**Тест 3: Короткий пароль**
1. Введите правильный текущий пароль
2. Введите новый пароль < 8 символов
3. Подтвердите новый пароль
4. Нажмите "Сменить пароль"

**Ожидаемый результат:**
- ✅ Ошибка "Пароль должен содержать минимум 8 символов"
- ✅ Сообщение на русском языке

#### 2.3 Успешная смена пароля

**Шаги:**
1. Введите правильный текущий пароль
2. Введите новый пароль (минимум 8 символов)
3. Подтвердите новый пароль
4. Нажмите "Сменить пароль"
5. Дождитесь сообщения об успехе
6. Подождите 3 секунды

**Ожидаемый результат:**
- ✅ Сообщение "Пароль успешно изменен"
- ✅ Сообщение на русском языке
- ✅ Сообщение автоматически исчезло через 3 секунды
- ✅ Кнопка была disabled во время отправки

#### 2.4 Проверка нового пароля

**Шаги:**
1. Выйдите из системы
2. Попробуйте войти со старым паролем
3. Попробуйте войти с новым паролем

**Ожидаемый результат:**
- ✅ Старый пароль не работает
- ✅ Новый пароль работает

**ВАЖНО:** Верните пароль обратно для дальнейшего тестирования!

### Этап 3: Управление проектами

#### 3.1 Просмотр списка проектов

**Шаги:**
1. Откройте `/admin/projects`
2. Проверьте отображение таблицы
3. Проверьте наличие колонок: название, категория, статус, дата
4. Проверьте кнопки действий

**Ожидаемый результат:**
- ✅ Таблица отображается корректно
- ✅ Данные загружаются
- ✅ Нет ошибок в консоли

#### 3.2 Создание проекта

**Шаги:**
1. Нажмите "Создать проект"
2. Заполните форму:
   - Название: "Тестовый проект регрессии"
   - Slug: автогенерируется
   - Категория: выберите любую
   - Описание: "Это тестовый проект для проверки регрессий"
3. Нажмите "Сохранить"

**Ожидаемый результат:**
- ✅ Проект создан
- ✅ Сообщение об успехе
- ✅ Проект появился в списке
- ✅ Кнопка была disabled во время сохранения

#### 3.3 Редактирование проекта

**Шаги:**
1. Найдите созданный проект
2. Нажмите "Редактировать"
3. Измените название на "Тестовый проект регрессии (обновлен)"
4. Нажмите "Сохранить"

**Ожидаемый результат:**
- ✅ Изменения сохранены
- ✅ Сообщение об успехе
- ✅ Новое название отображается в списке

#### 3.4 Добавление Hero медиа

**Шаги:**
1. Откройте детали проекта
2. Найдите секцию Hero Media
3. Загрузите изображение < 2MB

**Ожидаемый результат:**
- ✅ Изображение загружено
- ✅ Превью отображается
- ✅ Путь к файлу корректный (без /storage/)

**Тест валидации:**
1. Попробуйте загрузить изображение > 2MB

**Ожидаемый результат:**
- ✅ Ошибка "Размер файла превышает 2MB"
- ✅ Сообщение на русском языке

#### 3.5 Добавление блока контента

**Шаги:**
1. В деталях проекта найдите секцию "Блоки контента"
2. Нажмите "Добавить блок"
3. Введите текст блока
4. Нажмите "Сохранить"

**Ожидаемый результат:**
- ✅ Блок создан
- ✅ Текст отображается

#### 3.6 Добавление медиа в блок

**Шаги:**
1. В созданном блоке нажмите "Добавить медиа"
2. Загрузите изображение
3. Выберите layout (single/double)
4. Сохраните

**Ожидаемый результат:**
- ✅ Медиа добавлено
- ✅ Превью отображается
- ✅ Layout применен

#### 3.7 Удаление проекта

**Шаги:**
1. Вернитесь к списку проектов
2. Найдите тестовый проект
3. Нажмите "Удалить"
4. Подтвердите удаление в диалоге

**Ожидаемый результат:**
- ✅ Диалог подтверждения появился
- ✅ После подтверждения проект удален
- ✅ Проект исчез из списка

### Этап 4: Управление блогом

#### 4.1 Просмотр списка постов

**Шаги:**
1. Откройте `/admin/blog`
2. Проверьте отображение таблицы
3. Проверьте сортировку
4. Проверьте фильтрацию

**Ожидаемый результат:**
- ✅ Таблица отображается
- ✅ Данные загружаются
- ✅ Сортировка работает

#### 4.2 Создание блог-поста

**Шаги:**
1. Нажмите "Создать пост"
2. Заполните форму:
   - Заголовок: "Тестовый пост регрессии"
   - Slug: автогенерируется
   - Описание: краткое описание
   - Содержание: основной текст
3. Выберите категорию
4. Установите дату публикации
5. Нажмите "Сохранить"

**Ожидаемый результат:**
- ✅ Пост создан
- ✅ Сообщение об успехе
- ✅ Пост появился в списке

#### 4.3 Редактирование поста

**Шаги:**
1. Откройте созданный пост
2. Измените заголовок
3. Измените содержание
4. Сохраните

**Ожидаемый результат:**
- ✅ Изменения сохранены
- ✅ Новые данные отображаются

#### 4.4 Добавление блока в пост

**Шаги:**
1. В посте добавьте новый блок
2. Добавьте текст
3. Добавьте изображение
4. Сохраните

**Ожидаемый результат:**
- ✅ Блок создан
- ✅ Контент отображается

#### 4.5 Удаление поста

**Шаги:**
1. Удалите тестовый пост
2. Подтвердите удаление

**Ожидаемый результат:**
- ✅ Пост удален
- ✅ Исчез из списка

### Этап 5: Загрузка медиа файлов

#### 5.1 Валидация изображений

**Тест 1: Валидное изображение**
- Файл: < 2MB, jpg/png/webp
- Ожидаемый результат: ✅ Загружено успешно

**Тест 2: Большое изображение**
- Файл: > 2MB
- Ожидаемый результат: ✅ Ошибка "Размер файла превышает 2MB"

**Тест 3: Неподдерживаемый формат**
- Файл: gif/bmp
- Ожидаемый результат: ✅ Ошибка "Неподдерживаемый формат"

#### 5.2 Валидация видео

**Тест 1: Валидное видео**
- Файл: < 50MB, mp4/webm + постер
- Ожидаемый результат: ✅ Загружено успешно

**Тест 2: Большое видео**
- Файл: > 50MB
- Ожидаемый результат: ✅ Ошибка "Размер файла превышает 50MB"

**Тест 3: Видео без постера**
- Файл: mp4 без постера
- Ожидаемый результат: ✅ Ошибка "Требуется постер для видео"

**Тест 4: Неподдерживаемый формат**
- Файл: avi/mov
- Ожидаемый результат: ✅ Ошибка "Неподдерживаемый формат"

#### 5.3 Проверка путей к файлам

**Шаги:**
1. Загрузите любое изображение
2. Откройте DevTools → Network
3. Проверьте URL загруженного файла

**Ожидаемый результат:**
- ✅ Путь НЕ содержит `/storage/`
- ✅ Файл доступен по URL

### Этап 6: SEO управление

#### 6.1 Глобальные настройки

**Шаги:**
1. Откройте `/admin/seo-settings`
2. Измените глобальный title
3. Измените description
4. Сохраните

**Ожидаемый результат:**
- ✅ Изменения сохранены
- ✅ Сообщение об успехе

#### 6.2 SEO для страниц

**Шаги:**
1. Откройте `/admin/seo`
2. Выберите страницу (например, "Главная")
3. Измените title
4. Измените description
5. Сохраните

**Ожидаемый результат:**
- ✅ Изменения сохранены
- ✅ Данные отображаются в overview

#### 6.3 SEO для проекта

**Шаги:**
1. Откройте любой проект
2. Перейдите в раздел SEO
3. Измените meta title
4. Измените meta description
5. Сохраните

**Ожидаемый результат:**
- ✅ Изменения сохранены
- ✅ SEO данные обновлены

#### 6.4 SEO для блог-поста

**Шаги:**
1. Откройте любой блог-пост
2. Перейдите в раздел SEO
3. Измените meta данные
4. Сохраните

**Ожидаемый результат:**
- ✅ Изменения сохранены

### Этап 7: Homepage Editor

#### 7.1 Hero секция

**Шаги:**
1. Откройте `/admin/homepage-editor`
2. Измените заголовок hero
3. Измените подзаголовок
4. Сохраните

**Ожидаемый результат:**
- ✅ Изменения сохранены
- ✅ Сообщение об успехе

#### 7.2 Загрузка hero видео

**Шаги:**
1. Загрузите hero видео
2. Загрузите fallback изображение
3. Проверьте превью

**Ожидаемый результат:**
- ✅ Видео загружено
- ✅ Fallback изображение загружено
- ✅ Превью отображается

#### 7.3 Секции контента

**Шаги:**
1. Измените текст в различных секциях
2. Загрузите изображения
3. Сохраните изменения

**Ожидаемый результат:**
- ✅ Все изменения сохранены
- ✅ Контент обновлен

### Этап 8: Категории проектов

#### 8.1 Создание категории

**Шаги:**
1. Откройте `/admin/category`
2. Нажмите "Создать категорию"
3. Введите название
4. Slug автогенерируется
5. Сохраните

**Ожидаемый результат:**
- ✅ Категория создана
- ✅ Появилась в списке

#### 8.2 Изменение порядка

**Шаги:**
1. Используйте кнопки "Вверх"/"Вниз"
2. Измените порядок категорий

**Ожидаемый результат:**
- ✅ Порядок изменился
- ✅ Изменения сохранены

#### 8.3 Удаление категории

**Шаги:**
1. Удалите тестовую категорию
2. Подтвердите удаление

**Ожидаемый результат:**
- ✅ Категория удалена
- ✅ Проекты не удалены

### Этап 9: Проверка авторизации

#### 9.1 Автоматическое обновление токена

**Шаги:**
1. Войдите в систему
2. Откройте DevTools → Network
3. Работайте в админке 5-10 минут
4. Следите за запросами к API

**Ожидаемый результат:**
- ✅ В response headers есть `X-New-Token`
- ✅ Токен обновляется автоматически
- ✅ Нет прерываний в работе

#### 9.2 Обработка истекшего токена

**Шаги:**
1. Откройте DevTools → Application → Cookies
2. Удалите cookie `admin-token`
3. Попробуйте обратиться к любой admin странице

**Ожидаемый результат:**
- ✅ Редирект на `/admin/login`
- ✅ Сообщение об ошибке (если есть)

#### 9.3 Время жизни сессии

**Шаги:**
1. Войдите в систему БЕЗ "Запомнить меня"
2. Проверьте cookie в DevTools
3. Проверьте max-age

**Ожидаемый результат:**
- ✅ max-age = 28800 секунд (8 часов)

**Шаги:**
1. Войдите в систему С "Запомнить меня"
2. Проверьте cookie
3. Проверьте max-age

**Ожидаемый результат:**
- ✅ max-age = 2592000 секунд (30 дней)

### Этап 10: Производительность

#### 10.1 Lighthouse audit

**Шаги:**
1. Откройте любую admin страницу
2. Откройте DevTools → Lighthouse
3. Запустите audit для Performance

**Ожидаемый результат:**
- ✅ Performance score >= 70
- ✅ Нет критических проблем

#### 10.2 Bundle size

**Шаги:**
1. Запустите `npm run build` в frontend_next
2. Проверьте размер bundle в выводе

**Ожидаемый результат:**
- ✅ Размер не увеличился значительно
- ✅ Tree-shaking работает

#### 10.3 Lazy loading

**Шаги:**
1. Откройте DevTools → Network
2. Откройте admin страницу
3. Следите за загрузкой chunks

**Ожидаемый результат:**
- ✅ Компоненты загружаются по требованию
- ✅ Initial bundle небольшой

### Этап 11: Кросс-браузерное тестирование

#### 11.1 Chrome

**Шаги:**
1. Повторите основные тесты в Chrome
2. Проверьте autocomplete
3. Проверьте сохранение пароля

**Ожидаемый результат:**
- ✅ Все работает корректно

#### 11.2 Firefox

**Шаги:**
1. Повторите основные тесты в Firefox
2. Проверьте autocomplete
3. Проверьте сохранение пароля

**Ожидаемый результат:**
- ✅ Все работает корректно

#### 11.3 Safari (если доступен)

**Шаги:**
1. Повторите основные тесты в Safari
2. Проверьте autocomplete
3. Проверьте сохранение пароля

**Ожидаемый результат:**
- ✅ Все работает корректно

### Этап 12: Мобильная версия

#### 12.1 Адаптивность

**Шаги:**
1. Откройте DevTools → Device Toolbar
2. Выберите мобильное устройство (iPhone/Android)
3. Проверьте основные страницы

**Проверить:**
- [ ] Sidebar адаптируется
- [ ] Формы удобны для заполнения
- [ ] Таблицы адаптируются
- [ ] Кнопки достаточно большие
- [ ] Текст читаемый

**Ожидаемый результат:**
- ✅ Все элементы адаптированы
- ✅ Интерфейс удобен на мобильном

## Финальная проверка

### Чек-лист перед завершением

- [ ] Все основные функции работают
- [ ] Нет критических ошибок в консоли
- [ ] Валидация работает корректно
- [ ] Сообщения на русском языке
- [ ] Автоматическое скрытие сообщений работает
- [ ] Sidebar скрыт на странице логина
- [ ] Функция смены пароля работает
- [ ] Автоматическое обновление токенов работает
- [ ] Загрузка файлов с валидацией работает
- [ ] SEO управление работает
- [ ] Homepage editor работает
- [ ] Производительность не ухудшилась
- [ ] Кросс-браузерная совместимость OK
- [ ] Мобильная версия OK

## Отчет о проблемах

Если обнаружены проблемы, заполните следующую таблицу:

| № | Описание проблемы | Критичность | Шаги воспроизведения | Скриншот |
|---|-------------------|-------------|----------------------|----------|
| 1 |                   |             |                      |          |
| 2 |                   |             |                      |          |

**Критичность:**
- 🔴 Критическая - блокирует работу
- 🟡 Средняя - мешает работе, но есть workaround
- 🟢 Низкая - косметическая проблема

## Заключение

После завершения всех тестов:

1. Заполните чек-лист в TASK-29-REGRESSION-TESTING.md
2. Запустите автоматический тест: `.\test-regression-api.ps1`
3. Создайте итоговый отчет с результатами
4. Если все тесты пройдены - отметьте задачу как выполненную

**Статус тестирования:** [ ] В процессе / [ ] Завершено

**Дата завершения:** _______________

**Тестировщик:** _______________
