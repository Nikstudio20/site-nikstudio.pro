# Чеклист перед деплоем изменений Homepage Editor

## Проверка кода

- [x] Все файлы без синтаксических ошибок
- [x] TypeScript типы корректны
- [x] PHP код соответствует стандартам Laravel
- [x] Добавлена валидация на клиенте и сервере
- [x] Сохранены меры безопасности

---

## Функциональное тестирование

### Загрузка изображений

- [ ] SVG загружается в Hero секцию (логотип)
- [ ] SVG загружается в Контент секцию (логотипы клиентов)
- [ ] SVG загружается в Услуги секцию (изображения услуг)
- [ ] SVG загружается в Отзывы секцию (фото авторов)
- [ ] JPG загружается корректно
- [ ] PNG загружается корректно
- [ ] WEBP загружается корректно

### Валидация

- [ ] Файл >2MB отклоняется с понятным сообщением
- [ ] Неподдерживаемый формат отклоняется
- [ ] Показываются корректные сообщения об ошибках на русском

### Удаление видео

- [ ] Главное видео удаляется из интерфейса
- [ ] Файл главного видео удаляется из папки `storage/app/public/home/hero-videos/`
- [ ] Видео услуги удаляется из интерфейса
- [ ] Файл видео услуги удаляется из папки `storage/app/public/services/videos/`

### Замена видео

- [ ] При загрузке нового главного видео старое удаляется из папки
- [ ] При загрузке нового видео услуги старое удаляется из папки
- [ ] В папке остаётся только один файл (новый)

---

## Проверка совместимости

- [ ] Существующие изображения (JPG, PNG, WEBP) работают
- [ ] Вёрстка не нарушена на десктопе
- [ ] Вёрстка не нарушена на планшете
- [ ] Вёрстка не нарушена на мобильном
- [ ] Все секции отображаются корректно

---

## Проверка производительности

- [ ] Скорость загрузки админки не ухудшилась
- [ ] Скорость загрузки главной страницы не ухудшилась
- [ ] SVG изображения отображаются быстро
- [ ] Нет задержек при загрузке файлов

---

## Проверка безопасности

- [ ] Валидация MIME-типов работает на сервере
- [ ] Валидация размера файлов работает
- [ ] Проверка расширений файлов работает
- [ ] Нет возможности загрузить вредоносные файлы
- [ ] Path traversal атаки невозможны

---

## Проверка логов

- [ ] Нет ошибок в логах Laravel
- [ ] Нет ошибок в консоли браузера
- [ ] Логирование работает корректно
- [ ] Все операции логируются

---

## Проверка базы данных

- [ ] Пути к файлам сохраняются корректно
- [ ] При удалении видео записи обновляются
- [ ] Нет битых ссылок на файлы

---

## Проверка файловой системы

- [ ] Папка `storage/app/public/homepage/` существует
- [ ] Папка `storage/app/public/home/hero-videos/` существует
- [ ] Папка `storage/app/public/services/videos/` существует
- [ ] Права доступа к папкам корректны (755)
- [ ] Файлы создаются с корректными правами

---

## Документация

- [x] Создан файл `HOMEPAGE-EDITOR-FIXES.md` с описанием изменений
- [x] Создан файл `TEST-HOMEPAGE-EDITOR.md` с инструкцией по тестированию
- [x] Создан файл `КРАТКАЯ-СВОДКА-ИСПРАВЛЕНИЙ.md` с кратким описанием
- [x] Создан файл `CHECKLIST-ПЕРЕД-ДЕПЛОЕМ.md` (этот файл)

---

## Перед деплоем на продакшен

### Обязательно:

1. [ ] Все пункты чеклиста выше выполнены
2. [ ] Создан бэкап базы данных
3. [ ] Создан бэкап папки storage
4. [ ] Проверены права доступа к папкам на продакшене
5. [ ] Проверено свободное место на диске

### Команды для деплоя:

```bash
# 1. Обновить код
git pull origin main

# 2. Установить зависимости (если нужно)
cd backend_laravel
composer install --no-dev --optimize-autoloader

# 3. Очистить кеш
php artisan cache:clear
php artisan config:clear
php artisan view:clear

# 4. Проверить права доступа
chmod -R 755 storage
chmod -R 755 bootstrap/cache

# 5. Создать символическую ссылку (если нужно)
php artisan storage:link

# 6. Перезапустить фронтенд
cd ../frontend_next
npm run build
pm2 restart next-app
```

---

## После деплоя

- [ ] Проверить загрузку SVG на продакшене
- [ ] Проверить удаление видео на продакшене
- [ ] Проверить отображение SVG на фронтенде
- [ ] Проверить логи на наличие ошибок
- [ ] Проверить работу всех секций админки

---

## Откат изменений (если нужно)

Если что-то пошло не так:

```bash
# 1. Откатить код
git revert HEAD

# 2. Восстановить бэкап базы данных
mysql -u username -p database_name < backup.sql

# 3. Восстановить бэкап storage
cp -r storage_backup/* storage/

# 4. Очистить кеш
php artisan cache:clear
php artisan config:clear

# 5. Перезапустить приложение
pm2 restart all
```

---

## Контакты для поддержки

Если возникнут проблемы:
1. Проверьте логи: `backend_laravel/storage/logs/laravel.log`
2. Проверьте консоль браузера (F12)
3. Проверьте права доступа к папкам storage

---

## Статус

- [x] Разработка завершена
- [x] Код проверен
- [x] Документация создана
- [ ] Тестирование на локальном окружении
- [ ] Тестирование на staging
- [ ] Деплой на продакшен
- [ ] Проверка на продакшене

---

## Примечания

- Все изменения обратно совместимы
- Существующие изображения продолжат работать
- SVG файлы должны быть безопасными (без вредоносного кода)
- Рекомендуется использовать SVG для логотипов и иконок
