# Инструкция по тестированию исправлений видео на главной странице

## Подготовка

1. Убедитесь, что backend запущен:
   ```bash
   cd backend_laravel
   php artisan serve
   ```

2. Убедитесь, что frontend запущен:
   ```bash
   cd frontend_next
   npm run dev
   ```

3. Войдите в админку: `http://localhost:3000/admin/login`

## Тест 1: Загрузка главного видео

1. Откройте редактор главной страницы: `http://localhost:3000/admin/homepage-editor`
2. Прокрутите до секции "Управление главным видео"
3. Нажмите "Выбрать файл" и выберите видео файл (до 50 MB, формат mp4/webm)
4. Нажмите "Загрузить видео"

**Ожидаемый результат:**
- ✅ Отображается прогресс загрузки (0-100%)
- ✅ После загрузки появляется сообщение "Видео успешно загружено!"
- ✅ Видео отображается в секции "Текущее видео"
- ✅ Нет ошибок "Unauthenticated" или "Ошибка при загрузке видео"

## Тест 2: Удаление главного видео

1. В секции "Текущее видео" нажмите кнопку "Удалить"
2. Подтвердите удаление в диалоговом окне

**Ожидаемый результат:**
- ✅ Появляется сообщение "Видео успешно удалено!"
- ✅ Секция "Текущее видео" показывает "Видео не загружено"
- ✅ Нет ошибки "Unauthenticated"

## Тест 3: Загрузка видео услуг

1. Прокрутите до секции "Управление видео услуг"
2. Нажмите "Выбрать файл" и выберите видео файл
3. Нажмите "Загрузить видео"

**Ожидаемый результат:**
- ✅ Отображается прогресс загрузки
- ✅ После загрузки появляется сообщение "Видео услуги успешно загружено!"
- ✅ Видео отображается в секции "Видео для секции 'Видео продакшн'"
- ✅ Нет ошибок аутентификации

## Тест 4: Удаление видео услуг

1. В секции видео услуг нажмите кнопку "Удалить"
2. Подтвердите удаление

**Ожидаемый результат:**
- ✅ Появляется сообщение "Видео услуги успешно удалено!"
- ✅ Секция показывает "Видео не загружено"
- ✅ Нет ошибки "Unauthenticated"

## Тест 5: Валидация размера файла

1. Попробуйте загрузить видео файл больше 50 MB

**Ожидаемый результат:**
- ✅ Появляется ошибка "Файл слишком большой. Максимальный размер: 50 MB"
- ✅ Видео не загружается

## Тест 6: Валидация формата файла

1. Попробуйте загрузить файл неподдерживаемого формата (например, .avi или .txt)

**Ожидаемый результат:**
- ✅ Появляется ошибка валидации формата
- ✅ Файл не загружается

## Тест 7: Работа с истекшим токеном

1. Откройте DevTools (F12) → Application → Cookies
2. Удалите cookie `admin-token`
3. Попробуйте загрузить или удалить видео

**Ожидаемый результат:**
- ✅ Автоматическое перенаправление на страницу логина
- ✅ Нет "белого экрана смерти"

## Тест 8: Проверка других функций админки

Убедитесь, что исправления не сломали другие части:

1. Откройте список проектов: `http://localhost:3000/admin/projects`
2. Откройте список блогов: `http://localhost:3000/admin/blog`
3. Откройте настройки: `http://localhost:3000/admin/settings`

**Ожидаемый результат:**
- ✅ Все страницы загружаются корректно
- ✅ Нет ошибок в консоли браузера

## Проверка логов

Откройте консоль браузера (F12 → Console) и проверьте:
- ✅ Нет ошибок 401 (Unauthenticated)
- ✅ Нет ошибок CORS
- ✅ Запросы содержат заголовок `Authorization: Bearer <token>`

## Что делать при ошибках

Если тесты не проходят:

1. Проверьте, что backend запущен и доступен
2. Проверьте, что вы авторизованы в админке
3. Откройте DevTools → Network и проверьте запросы
4. Проверьте логи Laravel: `backend_laravel/storage/logs/laravel.log`
5. Очистите кэш браузера и перезагрузите страницу

## Успешное завершение

Все тесты пройдены успешно, если:
- ✅ Видео загружается и удаляется без ошибок
- ✅ Нет ошибок "Unauthenticated"
- ✅ Прогресс загрузки отображается корректно
- ✅ Валидация работает правильно
- ✅ Другие части админки работают нормально
